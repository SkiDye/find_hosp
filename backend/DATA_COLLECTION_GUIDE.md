# ë³‘ì› ìš´ì˜ì •ë³´ ìˆ˜ì§‘ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

155ê°œ ì˜ì›ì˜ **ì‹¤ì œ ìš´ì˜ì •ë³´**(ìš´ì˜ì‹œê°„, ì‘ê¸‰ì‹¤, 24ì‹œê°„, ì£¼ë§ì§„ë£Œ)ë¥¼ ìë™ìœ¼ë¡œ ìˆ˜ì§‘í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

## ğŸ—ï¸ ì‹œìŠ¤í…œ êµ¬ì¡°

```
DataAggregator (í†µí•© ê´€ë¦¬ì)
â”œâ”€â”€ HIRAProvider (ìš°ì„ ìˆœìœ„: 100) â­ ì¶”ì²œ
â”‚   â””â”€â”€ ê±´ê°•ë³´í—˜ì‹¬ì‚¬í‰ê°€ì› ê³µì‹ API
â”‚       âœ… ìš´ì˜ì‹œê°„ ì œê³µ
â”‚       âœ… ì‘ê¸‰ì‹¤ ì •ë³´
â”‚       âœ… ë¬´ë£Œ (ì¼ 10,000ê±´)
â”‚
â”œâ”€â”€ KakaoMapProvider (ìš°ì„ ìˆœìœ„: 80)
â”‚   â””â”€â”€ ì¹´ì¹´ì˜¤ ë¡œì»¬ API
â”‚       âš ï¸ ìš´ì˜ì‹œê°„ ë¯¸ì œê³µ (ê¸°ë³¸ ì •ë³´ë§Œ)
â”‚
â””â”€â”€ NaverPlaceProvider (ìš°ì„ ìˆœìœ„: 70)
    â””â”€â”€ ë„¤ì´ë²„ í”Œë ˆì´ìŠ¤
        âš ï¸ ê³µì‹ API ì—†ìŒ (í¬ë¡¤ë§ í•„ìš”)
        âŒ ê¸°ë³¸ ë¹„í™œì„±í™”
```

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1ë‹¨ê³„: API ì‹ ì²­ (1-2ì¼)

```bash
# ê°€ì´ë“œ í™•ì¸
cat backend/API_SIGNUP_GUIDE.md
```

**ì‹ ì²­í•  API**:
- ê±´ê°•ë³´í—˜ì‹¬ì‚¬í‰ê°€ì› - ì „êµ­ ë³‘ì˜ì› ì°¾ê¸° ì„œë¹„ìŠ¤
- URL: https://www.data.go.kr/data/15051059/openapi.do

### 2ë‹¨ê³„: API í‚¤ ì„¤ì •

ë°œê¸‰ë°›ì€ API í‚¤ë¥¼ í™˜ê²½ë³€ìˆ˜ ë˜ëŠ” ì„¤ì • íŒŒì¼ì— ì…ë ¥:

**ë°©ë²• A: í™˜ê²½ë³€ìˆ˜ (ì¶”ì²œ)**
```bash
# .env íŒŒì¼ ìƒì„±
HIRA_API_KEY=your_api_key_here
KAKAO_REST_API_KEY=your_kakao_key_here  # ì„ íƒ
```

**ë°©ë²• B: ì„¤ì • íŒŒì¼**
```javascript
// src/config/apiKeys.js
export const API_KEYS = {
  HIRA: 'your_api_key_here'
};
```

### 3ë‹¨ê³„: ìš´ì˜ì •ë³´ ì—…ë°ì´íŠ¸

```bash
cd backend

# ëª¨ë“  ì˜ì› ì—…ë°ì´íŠ¸ (155ê°œ)
node src/scripts/updateOperatingInfo.js

# íŠ¹ì • ì§€ì—­ë§Œ ì—…ë°ì´íŠ¸
node src/scripts/updateOperatingInfo.js --city=ê°•ë‚¨êµ¬

# íŠ¹ì • íƒ€ì…ë§Œ ì—…ë°ì´íŠ¸
node src/scripts/updateOperatingInfo.js --type=ì˜ì›
```

## ğŸ“Š ì‚¬ìš© ì˜ˆì‹œ

### ì˜ˆì‹œ 1: ì „ì²´ ì˜ì› ì—…ë°ì´íŠ¸

```bash
$ node src/scripts/updateOperatingInfo.js

================================================================================
ğŸ¥ ë³‘ì› ìš´ì˜ì •ë³´ ì—…ë°ì´íŠ¸
================================================================================

ğŸ”‘ API í‚¤ ê²€ì¦ ì¤‘...
âœ… API í‚¤ ê²€ì¦ ì™„ë£Œ

ğŸ“‹ ëŒ€ìƒ ë³‘ì›: 155ê°œ

================================================================================
ğŸ“Š ì¼ê´„ ì¡°íšŒ ì‹œì‘: 155ê°œ ë³‘ì›
   ë°°ì¹˜ í¬ê¸°: 5ê°œ
   ë°°ì¹˜ ê°„ ëŒ€ê¸°: 2000ms
================================================================================

ğŸ“¦ ë°°ì¹˜ 1/31 (5ê°œ ë³‘ì›)

ğŸ” [ê°•ë‚¨í”¼ë¶€ê³¼ì˜ì›] ìš´ì˜ì •ë³´ ì¡°íšŒ ì‹œì‘
   ğŸ”„ [HIRA_API] ì¡°íšŒ ì¤‘...
   âœ… [HIRA_API] ë°ì´í„° íšë“
   ğŸ¯ ì¶©ë¶„í•œ ë°ì´í„° íšë“, ì¡°íšŒ ì¢…ë£Œ

...

================================================================================
ğŸ“Š ì¼ê´„ ì¡°íšŒ ì™„ë£Œ
   âœ… ì„±ê³µ: 142ê°œ
   âŒ ì‹¤íŒ¨: 13ê°œ
   ğŸ“‹ ì „ì²´: 155ê°œ
================================================================================

ğŸ’¾ ë°ì´í„°ë² ì´ìŠ¤ ì—…ë°ì´íŠ¸ ì¤‘...

âœ… [1/155] ê°•ë‚¨í”¼ë¶€ê³¼ì˜ì› ì—…ë°ì´íŠ¸ ì™„ë£Œ
âœ… [2/155] ì²­ë‹´í”¼ë¶€ê³¼ì˜ì› ì—…ë°ì´íŠ¸ ì™„ë£Œ
...

================================================================================
ğŸ“Š ì—…ë°ì´íŠ¸ ì™„ë£Œ
================================================================================
âœ… ì—…ë°ì´íŠ¸: 142ê°œ
â­ï¸  ìŠ¤í‚µ: 13ê°œ
ğŸ“‹ ì „ì²´: 155ê°œ
================================================================================
```

## ğŸ”§ ê³ ê¸‰ ì„¤ì •

### ì»¤ìŠ¤í…€ Provider ì¶”ê°€

ìƒˆë¡œìš´ ë°ì´í„° ì†ŒìŠ¤ë¥¼ ì¶”ê°€í•˜ë ¤ë©´:

```javascript
// src/services/dataProviders/MyProvider.js
import { BaseProvider } from './BaseProvider.js';

export class MyProvider extends BaseProvider {
  constructor() {
    super('MY_PROVIDER', 90); // ì´ë¦„, ìš°ì„ ìˆœìœ„
  }

  async fetchOperatingInfo(hospital) {
    // ë°ì´í„° ì¡°íšŒ ë¡œì§
    return {
      has_emergency_room: false,
      open_24_hours: false,
      weekend_available: true,
      opening_hours: { /* ... */ },
      source: this.name
    };
  }
}
```

```javascript
// src/services/DataAggregator.jsì— ë“±ë¡
this.providers = [
  new HIRAProvider(),
  new MyProvider(),  // ì¶”ê°€
  new KakaoMapProvider()
];
```

### ë°°ì¹˜ ì„¤ì • ì¡°ì •

```javascript
// updateOperatingInfo.js
const results = await aggregator.fetchBulk(hospitals, {
  batchSize: 10,          // 10ê°œì”© ë™ì‹œ ì²˜ë¦¬ (ê¸°ë³¸: 5)
  delayBetweenBatches: 1000 // 1ì´ˆ ëŒ€ê¸° (ê¸°ë³¸: 2000ms)
});
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

### API ì‚¬ìš© ì œí•œ

- **ê±´ê°•ë³´í—˜ì‹¬ì‚¬í‰ê°€ì›**: ì¼ 10,000ê±´
- **ì¹´ì¹´ì˜¤ ë¡œì»¬**: ì¼ 30,000ê±´ (ë¬´ë£Œ)
- 155ê°œ ì˜ì› Ã— 1íšŒ = 155ê±´ ì‚¬ìš© (ì¶©ë¶„í•¨)

### í¬ë¡¤ë§ ê´€ë ¨

- ë„¤ì´ë²„/ì¹´ì¹´ì˜¤ í¬ë¡¤ë§ì€ **ì´ìš©ì•½ê´€ ìœ„ë°˜ ê°€ëŠ¥ì„±**
- ê³µì‹ API ì‚¬ìš© ê¶Œì¥
- í¬ë¡¤ë§ì€ ê¸°ë³¸ì ìœ¼ë¡œ **ë¹„í™œì„±í™”**ë¨

### ë°ì´í„° ì •í™•ì„±

- API ë°ì´í„°ë„ 100% ì •í™•í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ
- **ë³‘ì› ê´€ë¦¬ìê°€ ì§ì ‘ ìˆ˜ì •**í•˜ëŠ” ê²ƒì´ ê°€ì¥ ì •í™•
- ì£¼ê¸°ì ìœ¼ë¡œ ì¬ì¡°íšŒ ê¶Œì¥ (ì›” 1íšŒ)

## ğŸ”„ ìë™í™”

### Cronìœ¼ë¡œ ì •ê¸° ì—…ë°ì´íŠ¸

```bash
# crontab -e
# ë§¤ì£¼ ì¼ìš”ì¼ ìƒˆë²½ 3ì‹œ ì‹¤í–‰
0 3 * * 0 cd /path/to/backend && node src/scripts/updateOperatingInfo.js
```

### Node.js ìŠ¤ì¼€ì¤„ëŸ¬

```javascript
// src/schedulers/operatingInfoScheduler.js
import cron from 'node-cron';
import updateOperatingInfo from '../scripts/updateOperatingInfo.js';

// ë§¤ì£¼ ì¼ìš”ì¼ ìƒˆë²½ 3ì‹œ
cron.schedule('0 3 * * 0', async () => {
  console.log('ğŸ”„ ì •ê¸° ìš´ì˜ì •ë³´ ì—…ë°ì´íŠ¸ ì‹œì‘');
  await updateOperatingInfo();
});
```

## ğŸ“ ë¬¸ì œ í•´ê²°

### API í‚¤ê°€ ì‘ë™í•˜ì§€ ì•Šì„ ë•Œ

```bash
# API í‚¤ í…ŒìŠ¤íŠ¸
node src/scripts/testApiConnection.js
```

### íŠ¹ì • ë³‘ì›ë§Œ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨í•  ë•Œ

```javascript
// ê°œë³„ ë³‘ì› ë””ë²„ê¹…
const aggregator = new DataAggregator();
const hospital = { id: 1, name: 'ê°•ë‚¨í”¼ë¶€ê³¼ì˜ì›', address: '...' };
const result = await aggregator.fetchOperatingInfo(hospital);
console.log(result);
```

### í¬ë¡¤ë§ í™œì„±í™” (ë¹„ì¶”ì²œ)

```bash
# í™˜ê²½ë³€ìˆ˜ë¡œ í™œì„±í™”
ENABLE_NAVER_CRAWLING=true node src/scripts/updateOperatingInfo.js
```

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- [API ì‹ ì²­ ê°€ì´ë“œ](./API_SIGNUP_GUIDE.md)
- [ë°ì´í„° ìŠ¤í‚¤ë§ˆ](./src/database/schema.sql)
- [Provider ê°œë°œ ê°€ì´ë“œ](./src/services/dataProviders/BaseProvider.js)

## ğŸ’¡ ë‹¤ìŒ ë‹¨ê³„

1. âœ… API ì‹ ì²­ (1-2ì¼)
2. âœ… API í‚¤ ì„¤ì •
3. âœ… ìš´ì˜ì •ë³´ ì—…ë°ì´íŠ¸ ì‹¤í–‰
4. âœ… í”„ë¡ íŠ¸ì—”ë“œì—ì„œ í™•ì¸
5. ğŸ”„ ì •ê¸° ì—…ë°ì´íŠ¸ ìŠ¤ì¼€ì¤„ ì„¤ì • (ì„ íƒ)
6. ğŸ‘¥ ë³‘ì› ê´€ë¦¬ì ì‹œìŠ¤í…œìœ¼ë¡œ ì§€ì† ê´€ë¦¬
